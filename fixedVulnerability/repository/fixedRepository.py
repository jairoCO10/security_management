from typing import List
from datetime import datetime
from fixedVulnerability.models import FixedVulnerability as ORMFixed


class FixedVulnerabilityRepository:
    
    def __init__(self) -> None:
        '''
        '''
        pass

    def get_all_fixed(self)->List[ORMFixed]:

        return  ORMFixed.objects.all()


    def get_by_cve_id_fixed(self, cve_id: str) -> ORMFixed:
        return ORMFixed.objects.filter(cve_id=cve_id).first()


    def create_fixed(self, cve_id:str)->ORMFixed:
        exiting = self.get_by_cve_id_fixed(cve_id)
        return ORMFixed.objects.create(cve_id=cve_id) if not exiting else exiting

from typing import List
from datetime import datetime
from vulnerabilities.models import Vulnerability as ORMVulnerability
from django.utils.dateparse import parse_datetime  # Asegúrate de importar esta función si es la que usas

class VulnerabilityRepository:
    
    def __init__(self) -> None:

        pass
    def get_vulnerability(self)->List[ORMVulnerability]:
        return  ORMVulnerability.objects.all()
    

    async def create_vulnerability(self, cve_id: str, source_identifier: str, published: datetime,
                                   last_modified: datetime, vuln_status: str, description_en: str,
                                   description_es: str, severity: str, base_score: float,
                                   exploitability_score: float, impact_score: float) -> ORMVulnerability:

        repository = ORMVulnerability.objects.update_or_create(
            cve_id=cve_id,
            source_identifier= source_identifier,
            published= published,
            last_modified=last_modified,
            vuln_status = vuln_status,
            description_en= description_en,
            description_es =description_es,
            severity= severity,
            base_score =base_score , 
            exploitability_score= exploitability_score,
            impact_score = impact_score,
            )
        
        return repository
    
   
